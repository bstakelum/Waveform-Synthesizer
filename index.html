<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Hand-Drawn Waveform Synthesizer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <!-- App title and high-level layout container -->
  <h1>Hand-Drawn Waveform Synthesizer</h1>

  <div class="container">

    <!-- Camera Panel -->
    <div class="panel">
      <h2>Camera Input <small></small></h2>
      <div class="video-wrapper">
        <video id="video" autoplay playsinline></video>
        <canvas id="processingCanvas"></canvas>
      </div>
      <div class="controls">
        <!-- Primary action starts/stops camera; secondary controls appear while active -->
        <button id="startCamera">Start Camera</button>
        <div id="cameraControls" class="hidden">
          <button id="captureFrame">Capture Frame</button>
          <button id="resetROI">Reset ROI</button>
          <div class="camera-select-row">
            <button id="cameraToggle">Front</button>
          </div>
          <div class="roi-controls">
            <!-- ROI sliders define the rectangular capture region in percentages -->
            <div class="roi-row">
              <label>Top <input id="roiTop" type="range" min="0" max="80" value="20"> <span id="roiTopVal">20%</span></label>
              <label>Bottom <input id="roiBottom" type="range" min="20" max="100" value="80"> <span id="roiBottomVal">80%</span></label>
            </div>
            <div class="roi-row">
              <label>Left <input id="roiLeft" type="range" min="0" max="90" value="0"> <span id="roiLeftVal">0%</span></label>
              <label>Right <input id="roiRight" type="range" min="10" max="100" value="100"> <span id="roiRightVal">100%</span></label>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Waveform Panel -->
    <div class="panel">
      <h2>Synthesized Waveform <small></small></h2>
      <canvas id="waveformCanvas"></canvas>
      <!-- Web Audio transport -->
      <div class="controls audio-controls">
        <button id="playSynth">Play</button>
      </div>
      <!-- Extraction quality metrics from current capture -->
      <div id="debugPanel" class="debug-panel">
        <h3>Extraction Debug</h3>
        <div id="debugCompare">Capture a frame for synthesis metrics.</div>
      </div>
      <!-- Pixel-level view of the ROI used by extraction -->
      <div id="processedPreviewPanel" class="debug-panel">
        <h3>Processed Frame</h3>
        <canvas id="processedPreviewCanvas"></canvas>
      </div>
    </div>

  </div>

  <!-- processingCanvas moved into camera panel as overlay -->

  <script type="module" src="app.js"></script>
</body>
</html>
